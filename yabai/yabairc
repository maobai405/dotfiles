osascript -e 'tell application id "tracesOf.Uebersicht" to refresh'

yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"
sudo yabai --load-sa

# initialization
source ~/.config/yabai/initialization.sh

# ====
# Signals
# ====
# Initialize the temp folder when adding or removing displays
yabai -m signal --add event=display_added action="~/.config/yabai/initialization.sh"
yabai -m signal --add event=display_removed action="~/.config/yabai/initialization.sh"
yabai -m signal --add event=window_destroyed action="~/.config/yabai/auto-focus-to-new-one-when-window-destroyed.sh 2> /dev/null"
yabai -m signal --add event=application_hidden action="~/.config/yabai/auto-focus-to-new-one-when-window-destroyed.sh 2> /dev/null"
yabai -m signal --add event=window_minimized action="~/.config/yabai/auto-focus-to-new-one-when-window-destroyed.sh 2> /dev/null"

# yabai -m signal --add app='^Ghostty$' event=window_created action='yabai -m space --focus next; sleep 0.01; yabai -m space --focus prev'
# yabai -m signal --add app='^Ghostty$' event=window_destroyed action='yabai -m space --focus next; sleep 0.01; yabai -m space --focus prev'

yabai -m signal --add app='^Ghostty$' event=window_created action='yabai -m space --layout bsp'
abai -m signal --add app='^Ghostty$' event=window_destroyed action='yabai -m space --layout bsp'


# 将当前激活窗口置于最上层
yabai -m signal --add event=window_focused action="yabai -m window --sub-layer normal"

# 切换工作区自动聚焦
yabai -m signal --add event=space_changed action='yabai -m window --focus "$(yabai -m query --windows --space | jq .[0].id)"'

# 配置
yabai -m config \
    layout                     bsp \
    top_padding                10 \
    bottom_padding             60 \
    left_padding               10 \
    right_padding              10 \
    window_gap                 10 \
    mouse_follows_focus        off \
    focus_follows_mouse        off \
    window_placement           second_child \
    window_shadow              0.90 \
    window_opacity             on \
    active_window_opacity      1.0 \
    normal_window_opacity      1.0 \
    window_opacity_duration    0.2 \
    split_ratio                0.50 \
    split_type                 auto \
    auto_balance               off \
    mouse_modifier             fn \
    mouse_action1              move \
    mouse_action2              resize \
    window_animation_duration  0.2 \

# 配置JankyBorders
borders active_color=0xffffc0cb inactive_color=0xff494d64 width=5.0 &

# 下列应用禁用平铺
otherApp='^(uTools|QSpace Pro|Raycast|balenaEtcher|System Settings|IINA|访达|QSpace Pro|iShot Pro|日历|备忘录|微信|WeChatc|网易云音乐|Tencent Lemon|企业微信|预览|钉钉)$'
# yabai -m rule --add app="${otherApp}" manage=on sticky=on
# yabai -m rule --add app="${otherApp}" manage=off
